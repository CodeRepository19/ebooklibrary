@using System.Security.Claims;
@using Microsoft.AspNetCore.Identity
@inject SignInManager<ApplicationUser>  SignInManager
@inject UserManager<ApplicationUser> UserManager
@model EbookApplication.ViewModels.BookViewModel

@{
    ViewData["Title"] = "E-Books";
}

<div class="container-fluid">

    <div class="row mt-3">

        <div class="col-md-8" style="border-right:1px solid rgba(0, 0, 0, 0.1);">

            @*Search*@
            <div class="row mt-2">
                <div class="col-md-2"></div>
                <div class="col-md-8">
                    <form class="form-inline my-2 my-lg-0 d-inline" asp-controller="Books" asp-action="SearchBookLanding">
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="Search for books by Title / Technology" name="SearchString" autocomplete="off">
                            <div class="input-group-append">
                                <button class="btn btn-secondary" type="submit">
                                    <i class="fa fa-search"></i>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="col-md-2"></div>
            </div>

            @*Grossery*@
            <div class="row m-3">
                <div class="btn-group btn-group-sm">
                    @{
                    for (char c = 'A'; c <= 'Z'; c++)
                    {
                    <a name=@c asp-controller="Books" asp-action="ShowByLetterLanding" asp-route-id="@c" class="grocery letters border btn btn-default">&nbsp;@c&nbsp;</a>
                    }
                    }
                </div>
            </div>

            @*Approved Books*@
            <div id="div_GetApprovedBooks">
                @await Html.PartialAsync("_ApprovedBooksList")
            </div>
        </div>

        @*Events*@
        <div class="col-md-4">
            <div id="div_GetEvents">
                @await Html.PartialAsync("_EventsList")
            </div>
        </div>

    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        var ajax_call = function () {
            $.ajax({
                url: '/Books/Refresh',
                type: 'Post',
                success: function (objOperations) {
                    $("#div_GetApprovedBooks").html(objOperations);
                },
            });
        };

        var Interval = 20000; // 20 Seconds

        setInterval(ajax_call, Interval);
    });

    $(document).ready(function () {
        var ajaxEvent_call = function () {
            $.ajax({
                url: '/Events/EventsList',
                type: 'Post',
                success: function (objOperations) {
                    $("#div_GetEvents").html(objOperations);
                },
            });
        };

        var Interval = 10000; // 10 Seconds

        setInterval(ajaxEvent_call, Interval);
    });

</script>
